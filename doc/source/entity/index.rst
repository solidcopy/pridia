################
エンティティ設計
################

========
クラス図
========

.. uml::

   class 出来事 {
     発生日 : 日付
     表題 : ラベル
     内容 : テキスト
   }

   class 写真 {
     表題 : ラベル
     写真 : 画像
   }
   出来事 "1" -- "*" 写真

   class 活動 {
     名前 : ラベル
     説明 : テキスト
   }
   出来事 "*" -- "0..1" 活動

   enum 活動状態 {
     未着手
     進行中
     休止中
     完了
     中止
   }
   活動 "*" -- "1" 活動状態

   class 取引 {
     発生日 : 日付
     要更新() : 真偽
   }

   class 取引明細 {
     品目 : ラベル
     数量 : 整数
     小計 : 整数
     備考 : テキスト
   }
   取引 "1" -- "1..*" 取引明細

   class 定期購入 {
     名前 : ラベル
     次回支払日() : 日付
     次回支払作成() : 取引
   }
   取引 "*" -- "0..1" 定期購入

   enum 定期購入状態 {
     利用中
     利用停止中
   }
   定期購入 "*" -- "1" 定期購入状態

   class 支払タイミング {
     次回支払日ルール : ロジック
   }
   定期購入 "*" -- "1" 支払タイミング
   note "毎月指定日、月末など。\n次回支払日ルールは前回の支払日から次の支払日を決定する。" as 支払タイミングコメント
   支払タイミング .. 支払タイミングコメント

   class 所有物 {
     名前 : ラベル
     説明 : テキスト
   }
   出来事 "0..1" -- "0..1" 所有物 : 入手
   出来事 "0..1" -- "0..1" 所有物 : 放棄
   取引明細 "0..1" -- "0..1" 所有物 : 購入
   取引明細 "0..1" -- "0..1" 所有物 : 売却

   enum 所有状態 {
     所有
     不所有
   }
   所有物 "*" -- "1" 所有状態

   class タグ {
     名前 : ラベル
   }
   タグ "0..1" <-- "*" タグ : 親
   活動 "*" -- "*" タグ
   取引明細 "*" -- "*" タグ
   定期購入 "*" -- "*" タグ

.. uml::

   class 芸術作品 {
     表題 : ラベル
   }

   class 単発作品 extends 芸術作品 {
   }

   class 連続作品 extends 芸術作品 {
   }

   class 鑑賞 {
     鑑賞日 : 日付
     コメント : テキスト
   }
   単発作品 "0..1" -- "1..*" 鑑賞

   class 視聴方法 {
     名前 : ラベル
   }
   鑑賞 "*" -- "1" 視聴方法

   class 表現形式 {
     名前 : ラベル
   }
   芸術作品 "*" -- "1" 表現形式
   note "小説、ドラマ、アニメなど" as 表現形式コメント
   表現形式 .. 表現形式コメント

   class 鑑賞期間 {
     コメント : テキスト
   }
   連続作品 "1" -- "*" 鑑賞期間
   鑑賞 "*" -- "0..1" 鑑賞期間

   enum 鑑賞状態 {
     継続中
     完了
     中止
   }
   鑑賞期間 "*" -- "1" 鑑賞状態

============
論理データ型
============

エンティティ設計は特定の実装手段に依存しない形で作成する。

そのため、属性のデータ型は論理データ型として抽象化し、
具体的なデータ型は実装手段に合わせて決められるようにする。

.. list-table::
   :header-rows: 1
   :widths: 20 80

   * - 論理型
     - 説明（型名で足りるものは省略）
   * - ラベル
     - 1行の文字列。前後に空白文字はない。
   * - テキスト
     - 複数の行からなる文字列。
   * - 日付
     -
   * - 真偽
     -
   * - 整数
     -
   * - 画像
     -
   * - ロジック
     - 計算式などの実行して結果を生成できるもの。

==============
オブジェクト図
==============

ユースケースによるデータ更新をオブジェクト図で表す。

日常的な出来事を記録する
*************************

出来事を記録する
-----------------

.. uml::

   object 出来事

写真を添付する
---------------

.. uml::

   object 出来事
   object 写真1
   object 写真2

   出来事 o-- 写真1
   出来事 o-- 写真2

活動の進捗を記録する
**********************

活動を登録する
----------------

.. uml::

   object 活動 {
     名前 = "Reactの習得"
   }
   object タグ {
     名前 = "技術調査"
   }

   活動 o-- タグ

日々の進捗を記録する
-----------------------

.. uml::

   object 活動 {
     名前 = "Reactの習得"
   }
   object タグ {
     名前 = "技術調査"
   }
   object 出来事1 {
     発生日 = "12/01"
     表題 = "開始"
   }
   object 出来事2 {
     発生日 = "12/02"
     表題 = "基本を理解"
   }
   object 出来事3 {
     発生日 = "12/03"
     表題 = "チュートリアル完了"
   }

   活動 o-- タグ
   活動 o-- 出来事1
   活動 o-- 出来事2
   活動 o-- 出来事3

所有物の入手から放棄まで
**************************

購入した
--------

.. uml::

   object 所有物
   object "取引" as 購入取引
   object "取引明細" as 購入取引明細
   object "出来事" as 購入

   所有物 -- 購入 : 購入
   所有物 -- 購入取引明細 : 購入
   購入取引 *-- 購入取引明細

放棄した
--------

.. uml::

   object 所有物
   object "取引" as 購入取引
   object "取引明細" as 購入取引明細
   object "出来事" as 購入
   object "出来事" as 放棄

   所有物 -- 購入 : 購入
   所有物 -- 購入取引明細 : 購入
   購入取引 *-- 購入取引明細
   所有物 -- 放棄 : 放棄

単発作品を鑑賞する
************************

初めて鑑賞した
----------------

.. uml::

   object 単発作品
   object 表現形式
   object 鑑賞

   単発作品 o-- 表現形式
   単発作品 *-- 鑑賞

もう一度鑑賞した
-------------------

.. uml::

   object 単発作品
   object 表現形式
   object 鑑賞1
   object 鑑賞2

   単発作品 o-- 表現形式
   単発作品 *-- 鑑賞1
   単発作品 *-- 鑑賞2

連続作品を鑑賞する
*****************************

見始めた
-----------

.. uml::

   object 連続作品
   object 表現形式
   object 鑑賞期間
   object 鑑賞
   object 視聴方法

   連続作品 o-- 表現形式
   連続作品 *-- 鑑賞期間
   鑑賞期間 *-- 鑑賞
   鑑賞 o-- 視聴方法

鑑賞を追加する
----------------

.. uml::

   object 連続作品
   object 表現形式
   object 鑑賞期間
   object "鑑賞" as 鑑賞1
   object "鑑賞" as 鑑賞2
   object "鑑賞" as 鑑賞3
   object 視聴方法

   連続作品 o-- 表現形式
   連続作品 *-- 鑑賞期間
   鑑賞期間 *-- 鑑賞1
   鑑賞期間 *-- 鑑賞2
   鑑賞期間 *-- 鑑賞3
   鑑賞1 o-- 視聴方法
   鑑賞2 o-- 視聴方法
   鑑賞3 o-- 視聴方法

サブスクを利用する
*********************

サブスクに登録する
----------------------

.. uml::

   object 定期購入
   object 支払タイミング
   object 取引
   object 取引明細

   定期購入 o-- 支払タイミング
   定期購入 o-- 取引
   取引 *-- 取引明細

何度か支払をする
------------------

.. uml::

   object 定期購入
   object 支払タイミング
   object "取引" as trade_1
   object "取引" as trade_2
   object "取引" as trade_3
   object "取引明細" as trade_detail_1
   object "取引明細" as trade_detail_2
   object "取引明細" as trade_detail_3

   定期購入 o-- 支払タイミング
   定期購入 o-- trade_1
   定期購入 o-- trade_2
   定期購入 o-- trade_3
   trade_1 *-- trade_detail_1
   trade_2 *-- trade_detail_2
   trade_3 *-- trade_detail_3
